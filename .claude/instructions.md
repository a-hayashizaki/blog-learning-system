# Claude Code 開発指示

## システム概要
ブログ記事の品質を学習により継続的に向上させるNext.jsアプリケーション。コーチング・セルフコンパッション分野の体験共有ブログに特化。

## 開発タスク優先順位

### 1. 基本構造構築（最優先）
- [ ] React Router 7 + Viteプロジェクト初期化
- [ ] Prismaセットアップとデータベース初期化
- [ ] 基本的なディレクトリ構造作成
- [ ] 環境変数設定（.env.local）
- [ ] Notion風UIの基本レイアウト実装

### 2. Notion風エディタUI
- [ ] ヘッダーコンポーネント（ロゴ、ステータス、公開ボタン）
- [ ] タイトル入力エリア（大型フォント、メタ情報表示）
- [ ] 気づきメモセクション（黄色アクセント、フレンドリーなUI）
- [ ] AI生成記事セクション（青ヘッダー、編集・再生成ボタン）
- [ ] フィードバックエリア（5段階評価、コメント入力）
- [ ] フローティング学習情報（右下固定、統計表示）
### 3. 記事生成・管理機能
- [ ] メモ入力・保存機能
- [ ] 記事生成API（Google Gemini連携）
- [ ] 記事編集・再生成機能
- [ ] 記事一覧・履歴表示

### 3. フィードバック機能
- [ ] 自己評価フォーム（5段階+コメント）
- [ ] フィードバック一覧表示
- [ ] 評価データの統計表示

### 4. 学習機能（核心）
- [ ] 過去データ分析ロジック
- [ ] プロンプト自動生成機能
- [ ] 学習パターン抽出アルゴリズム
- [ ] 品質予測機能

### 5. note API連携
- [ ] note API認証設定
- [ ] 外部データ取得バッチ処理
- [ ] データ同期機能

### 6. ダッシュボード
- [ ] 品質推移グラフ
- [ ] テーマ別分析
- [ ] 学習効果可視化

## 重要な実装ポイント

### Notion風UIの実装
- **レスポンシブ対応**: モバイルでも快適な執筆環境
- **フォーカス管理**: タイトル→メモ→記事のスムーズな遷移
- **リアルタイム保存**: 入力内容の自動保存機能
- **ステータス表示**: AI学習状況、保存状況の可視化

### 学習アルゴリズム
```javascript
// Phase 1: プロンプト方式学習の実装例
const generateOptimizedPrompt = (pastArticles) => {
  // 高評価記事の特徴抽出
  const highRatedArticles = pastArticles.filter(a => a.selfRating >= 4);
  const avgExperienceRatio = calculateAverage(highRatedArticles, 'experienceRatio');
  
  // 最適化されたプロンプト生成
  return `
    過去の成功パターンに基づき以下を重視:
    - 体験描写: ${avgExperienceRatio}%程度
    - 語調: カジュアルレベル${avgCasualness}
    - 構成: ${preferredStructure}
    
    以下の調整指示を適用:
    - 共感重視で体験を具体的に記載
    - 言葉を丁寧すぎない程度に調整
    - 会話形式ではなく自然な文章形式で
  `;
};
```

### データモデル（Prisma）
既に設計済み。特に注意すべき点:
- `experienceRatio`, `casualnessLevel`等の生成パラメータ
- 自己評価と外部反応の分離
- 学習パターンの効果測定

### UI/UX方針
- シンプルで直感的なインターフェース
- 記事作成の負担を最小限に
- 学習効果が見える化されたダッシュボード
- レスポンシブ対応（Tailwind CSS使用）

## 開発制約・注意点

### 技術制約
- ローカル環境での動作（SQLite使用）
- Google Gemini API利用（キー設定必要）
- note API認証済み
- devcontainer環境での開発
- React Router 7 + Vite構成

### 品質要件
- TypeScript strict mode
- エラーハンドリング充実
- データ整合性の保証
- パフォーマンス考慮（学習処理の最適化）

### セキュリティ
- API キーの適切な管理
- note認証情報の保護
- SQLインジェクション対策（Prisma使用で基本対応済み）

## 初期開発での重要な判断点

1. **記事生成AI**: Google Gemini APIを使用、プロンプトエンジニアリング重視
2. **学習方式**: まずプロンプト方式、後でベクター方式に移行
3. **UI優先度**: 機能性重視、後で洗練化
4. **データ構造**: 拡張性を考慮した設計

## 期待する成果物

### Phase 1完了時
- 気づきメモから記事生成できる
- 自己フィードバックを蓄積できる
- 基本的な学習機能が動作する
- 品質向上が数値で確認できる

### Phase 2完了時
- note APIとの完全連携
- 外部反応データの活用
- 高度な学習アルゴリズム
- 予測・分析機能

この要件定義を基に、実用的で拡張性のあるシステムを構築してください。